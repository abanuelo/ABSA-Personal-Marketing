n_trainable_params: 2526004, n_nontrainable_params: 1136100
> training arguments:
>>> model_name: atae_lstm
>>> dataset: oil
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x12773f840>
>>> learning_rate: 0.001
>>> dropout: 0.1
>>> l2reg: 0.01
>>> num_epoch: 20
>>> batch_size: 64
>>> log_step: 5
>>> embed_dim: 300
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> max_seq_len: 80
>>> polarities_dim: 4
>>> hops: 3
>>> device: cpu
>>> seed: None
>>> valset_ratio: 0
>>> model_class: <class 'models.atae_lstm.ATAE_LSTM'>
>>> dataset_file: {'train': './datasets/semeval14/Oil_Train.xml.seg', 'test': './datasets/semeval14/Oil_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_raw_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 1.1351, acc: 0.5188
loss: 1.0662, acc: 0.5891
loss: 1.0301, acc: 0.6000
loss: 0.9820, acc: 0.6164
loss: 0.9543, acc: 0.6250
loss: 0.9366, acc: 0.6307
loss: 0.9164, acc: 0.6366
loss: 0.8894, acc: 0.6523
loss: 0.8805, acc: 0.6583
loss: 0.8648, acc: 0.6678
> val_acc: 0.7013, val_f1: 0.3752
>> saved: state_dict/atae_lstm_oil_val_acc0.7013
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.6809, acc: 0.7438
loss: 0.6820, acc: 0.7703
loss: 0.6802, acc: 0.7646
loss: 0.6891, acc: 0.7586
loss: 0.6860, acc: 0.7550
loss: 0.6956, acc: 0.7505
loss: 0.6771, acc: 0.7616
loss: 0.6740, acc: 0.7648
loss: 0.6665, acc: 0.7663
loss: 0.6616, acc: 0.7699
> val_acc: 0.8111, val_f1: 0.6995
>> saved: state_dict/atae_lstm_oil_val_acc0.8111
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.5889, acc: 0.7906
loss: 0.5735, acc: 0.8000
loss: 0.5477, acc: 0.8229
loss: 0.5279, acc: 0.8289
loss: 0.5198, acc: 0.8294
loss: 0.5055, acc: 0.8323
loss: 0.5059, acc: 0.8348
loss: 0.5096, acc: 0.8328
loss: 0.5163, acc: 0.8299
loss: 0.5170, acc: 0.8298
> val_acc: 0.8017, val_f1: 0.7466
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.4814, acc: 0.8375
loss: 0.4489, acc: 0.8562
loss: 0.4898, acc: 0.8406
loss: 0.4852, acc: 0.8398
loss: 0.4976, acc: 0.8369
loss: 0.4898, acc: 0.8385
loss: 0.4878, acc: 0.8384
loss: 0.4874, acc: 0.8391
loss: 0.4891, acc: 0.8396
loss: 0.4802, acc: 0.8418
> val_acc: 0.8383, val_f1: 0.7521
>> saved: state_dict/atae_lstm_oil_val_acc0.8383
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.4432, acc: 0.8594
loss: 0.4487, acc: 0.8562
loss: 0.4754, acc: 0.8521
loss: 0.4757, acc: 0.8508
loss: 0.4893, acc: 0.8394
loss: 0.4985, acc: 0.8396
loss: 0.4993, acc: 0.8375
loss: 0.4936, acc: 0.8383
loss: 0.4889, acc: 0.8410
loss: 0.4803, acc: 0.8444
> val_acc: 0.8264, val_f1: 0.7813
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.3918, acc: 0.8719
loss: 0.4220, acc: 0.8516
loss: 0.4242, acc: 0.8542
loss: 0.4124, acc: 0.8586
loss: 0.4113, acc: 0.8600
loss: 0.4234, acc: 0.8552
loss: 0.4318, acc: 0.8513
loss: 0.4349, acc: 0.8535
loss: 0.4467, acc: 0.8486
loss: 0.4496, acc: 0.8479
> val_acc: 0.8430, val_f1: 0.8112
>> saved: state_dict/atae_lstm_oil_val_acc0.843
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.3841, acc: 0.8844
loss: 0.4204, acc: 0.8625
loss: 0.4340, acc: 0.8573
loss: 0.4443, acc: 0.8477
loss: 0.4497, acc: 0.8456
loss: 0.4476, acc: 0.8474
loss: 0.4436, acc: 0.8473
loss: 0.4347, acc: 0.8516
loss: 0.4337, acc: 0.8510
loss: 0.4305, acc: 0.8542
> val_acc: 0.8394, val_f1: 0.8063
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.3679, acc: 0.8750
loss: 0.4284, acc: 0.8625
loss: 0.4681, acc: 0.8458
loss: 0.4574, acc: 0.8523
loss: 0.4787, acc: 0.8438
loss: 0.4697, acc: 0.8448
loss: 0.4677, acc: 0.8424
loss: 0.4580, acc: 0.8445
loss: 0.4529, acc: 0.8458
loss: 0.4491, acc: 0.8482
> val_acc: 0.8394, val_f1: 0.8027
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.3837, acc: 0.8562
loss: 0.4023, acc: 0.8469
loss: 0.4053, acc: 0.8573
loss: 0.4071, acc: 0.8586
loss: 0.3949, acc: 0.8631
loss: 0.4017, acc: 0.8625
loss: 0.4029, acc: 0.8589
loss: 0.4042, acc: 0.8594
loss: 0.4152, acc: 0.8562
loss: 0.4086, acc: 0.8596
> val_acc: 0.8359, val_f1: 0.7992
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.3474, acc: 0.8812
loss: 0.3448, acc: 0.8797
loss: 0.3630, acc: 0.8760
loss: 0.3732, acc: 0.8750
loss: 0.3756, acc: 0.8731
loss: 0.3831, acc: 0.8693
loss: 0.3943, acc: 0.8670
loss: 0.4073, acc: 0.8637
loss: 0.4026, acc: 0.8660
loss: 0.4015, acc: 0.8659
> val_acc: 0.8548, val_f1: 0.8278
>> saved: state_dict/atae_lstm_oil_val_acc0.8548
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.3097, acc: 0.9125
loss: 0.3711, acc: 0.8859
loss: 0.3828, acc: 0.8802
loss: 0.3832, acc: 0.8773
loss: 0.3846, acc: 0.8750
loss: 0.3877, acc: 0.8724
loss: 0.3911, acc: 0.8705
loss: 0.3967, acc: 0.8660
loss: 0.3995, acc: 0.8653
loss: 0.3935, acc: 0.8672
> val_acc: 0.8359, val_f1: 0.7964
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.3973, acc: 0.8625
loss: 0.3750, acc: 0.8781
loss: 0.3901, acc: 0.8750
loss: 0.3972, acc: 0.8719
loss: 0.3890, acc: 0.8781
loss: 0.3896, acc: 0.8781
loss: 0.3922, acc: 0.8732
loss: 0.3893, acc: 0.8730
loss: 0.3853, acc: 0.8722
loss: 0.3843, acc: 0.8716
> val_acc: 0.8442, val_f1: 0.8008
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
loss: 0.3409, acc: 0.8938
loss: 0.3600, acc: 0.8859
loss: 0.3525, acc: 0.8833
loss: 0.3676, acc: 0.8781
loss: 0.3767, acc: 0.8750
loss: 0.3664, acc: 0.8792
loss: 0.3639, acc: 0.8808
loss: 0.3727, acc: 0.8766
loss: 0.3739, acc: 0.8760
loss: 0.3760, acc: 0.8735
> val_acc: 0.8548, val_f1: 0.8237
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
loss: 0.3962, acc: 0.8625
loss: 0.4083, acc: 0.8531
loss: 0.3796, acc: 0.8667
loss: 0.3853, acc: 0.8656
loss: 0.3822, acc: 0.8694
loss: 0.3730, acc: 0.8745
loss: 0.3738, acc: 0.8754
loss: 0.3653, acc: 0.8801
loss: 0.3683, acc: 0.8781
loss: 0.3663, acc: 0.8777
> val_acc: 0.8512, val_f1: 0.8102
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
loss: 0.3319, acc: 0.8844
loss: 0.3226, acc: 0.8812
loss: 0.3334, acc: 0.8844
loss: 0.3505, acc: 0.8789
loss: 0.3528, acc: 0.8806
loss: 0.3586, acc: 0.8755
loss: 0.3506, acc: 0.8795
loss: 0.3523, acc: 0.8773
loss: 0.3568, acc: 0.8764
loss: 0.3558, acc: 0.8786
> val_acc: 0.8548, val_f1: 0.8151
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 15
loss: 0.3248, acc: 0.8938
loss: 0.3002, acc: 0.9016
loss: 0.2878, acc: 0.9021
loss: 0.2961, acc: 0.9000
loss: 0.3167, acc: 0.8944
loss: 0.3223, acc: 0.8927
loss: 0.3373, acc: 0.8857
loss: 0.3462, acc: 0.8840
loss: 0.3578, acc: 0.8812
loss: 0.3607, acc: 0.8792
> val_acc: 0.8489, val_f1: 0.8131
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 16
loss: 0.3847, acc: 0.8625
loss: 0.3743, acc: 0.8828
loss: 0.3583, acc: 0.8885
loss: 0.3488, acc: 0.8875
loss: 0.3579, acc: 0.8806
loss: 0.3583, acc: 0.8807
loss: 0.3660, acc: 0.8759
loss: 0.3627, acc: 0.8781
loss: 0.3610, acc: 0.8806
loss: 0.3565, acc: 0.8802
> val_acc: 0.8524, val_f1: 0.8249
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 17
loss: 0.3137, acc: 0.8906
loss: 0.3417, acc: 0.8766
loss: 0.3174, acc: 0.8854
loss: 0.3307, acc: 0.8820
loss: 0.3319, acc: 0.8831
loss: 0.3351, acc: 0.8828
loss: 0.3407, acc: 0.8835
loss: 0.3421, acc: 0.8840
loss: 0.3418, acc: 0.8847
loss: 0.3448, acc: 0.8840
> val_acc: 0.8548, val_f1: 0.8179
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 18
loss: 0.3299, acc: 0.8781
loss: 0.3262, acc: 0.8828
loss: 0.3246, acc: 0.8854
loss: 0.3115, acc: 0.8922
loss: 0.3044, acc: 0.8975
loss: 0.3098, acc: 0.8958
loss: 0.3253, acc: 0.8902
loss: 0.3259, acc: 0.8895
loss: 0.3297, acc: 0.8875
loss: 0.3399, acc: 0.8849
> val_acc: 0.8512, val_f1: 0.8122
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 19
loss: 0.3509, acc: 0.8812
loss: 0.3531, acc: 0.8734
loss: 0.3504, acc: 0.8688
loss: 0.3411, acc: 0.8734
loss: 0.3420, acc: 0.8756
loss: 0.3454, acc: 0.8740
loss: 0.3397, acc: 0.8812
loss: 0.3399, acc: 0.8816
loss: 0.3403, acc: 0.8795
loss: 0.3440, acc: 0.8789
> val_acc: 0.8477, val_f1: 0.8204
>> test_acc: 0.8548, test_f1: 0.8278
